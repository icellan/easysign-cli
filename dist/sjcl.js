"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_typeof2=_interopRequireDefault(require("@babel/runtime/helpers/typeof")),sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function corrupt(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function invalid(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function bug(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function notReady(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};sjcl.cipher.aes=function(e){this._tables[0][0][0]||this._precompute();var t,r,a,c,n,o=this._tables[0][4],s=this._tables[1],l=e.length,d=1;if(4!==l&&6!==l&&8!==l)throw new sjcl.exception.invalid("invalid aes key size");for(this._key=[c=e.slice(0),n=[]],t=l;t<4*l+28;t++)a=c[t-1],(0==t%l||8===l&&4==t%l)&&(a=o[a>>>24]<<24^o[255&a>>16]<<16^o[255&a>>8]<<8^o[255&a],0==t%l&&(a=a<<8^a>>>24^d<<24,d=d<<1^283*(d>>7))),c[t]=c[t-l]^a;for(r=0;t;r++,t--)a=c[3&r?t:t-4],n[r]=4>=t||4>r?a:s[0][o[a>>>24]]^s[1][o[255&a>>16]]^s[2][o[255&a>>8]]^s[3][o[255&a]]},sjcl.cipher.aes.prototype={encrypt:function encrypt(e){return this._crypt(e,0)},decrypt:function decrypt(e){return this._crypt(e,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function _precompute(){var e,t,r,a,c,n,o,l,u,m=this._tables[0],b=this._tables[1],f=m[4],p=b[4],h=[],d=[];for(e=0;256>e;e++)d[(h[e]=e<<1^283*(e>>7))^e]=e;for(t=r=0;!f[t];t^=a||1,r=d[r]||1)for(o=r^r<<1^r<<2^r<<3^r<<4,o=99^(o>>8^255&o),f[t]=o,p[o]=t,n=h[c=h[a=h[t]]],u=16843009*n^65537*c^257*a^16843008*t,l=257*h[o]^16843008*o,e=0;4>e;e++)m[e][t]=l=l<<24^l>>>8,b[e][o]=u=u<<24^u>>>8;for(e=0;5>e;e++)m[e]=m[e].slice(0),b[e]=b[e].slice(0)},_crypt:function _crypt(e,t){if(4!==e.length)throw new sjcl.exception.invalid("invalid aes block size");var r,n,o,s,l=this._key[t],u=e[0]^l[0],m=e[t?3:1]^l[1],f=e[2]^l[2],p=e[t?1:3]^l[3],h=l.length/4-2,_=4,g=[0,0,0,0],y=this._tables[t],v=y[0],x=y[1],E=y[2],B=y[3],F=y[4];for(s=0;s<h;s++)r=v[u>>>24]^x[255&m>>16]^E[255&f>>8]^B[255&p]^l[_],n=v[m>>>24]^x[255&f>>16]^E[255&p>>8]^B[255&u]^l[_+1],o=v[f>>>24]^x[255&p>>16]^E[255&u>>8]^B[255&m]^l[_+2],p=v[p>>>24]^x[255&u>>16]^E[255&m>>8]^B[255&f]^l[_+3],_+=4,u=r,m=n,f=o;for(s=0;4>s;s++)g[t?3&-s:s]=F[u>>>24]<<24^F[255&m>>16]<<16^F[255&f>>8]<<8^F[255&p]^l[_++],r=u,u=m,m=f,f=p,p=r;return g}},sjcl.bitArray={bitSlice:function bitSlice(e,t,i){return e=sjcl.bitArray._shiftRight(e.slice(t/32),32-(31&t)).slice(1),void 0===i?e:sjcl.bitArray.clamp(e,i-t)},extract:function extract(e,t,i){var r,a=Math.floor(31&-t-i);return r=-32&(t+i-1^t)?e[0|t/32]<<32-a^e[0|t/32+1]>>>a:e[0|t/32]>>>a,r&(1<<i)-1},concat:function concat(e,t){if(0===e.length||0===t.length)return e.concat(t);var i=e[e.length-1],r=sjcl.bitArray.getPartial(i);return 32===r?e.concat(t):sjcl.bitArray._shiftRight(t,r,0|i,e.slice(0,e.length-1))},bitLength:function bitLength(e){var t,i=e.length;return 0===i?0:(t=e[i-1],32*(i-1)+sjcl.bitArray.getPartial(t))},clamp:function clamp(e,t){if(32*e.length<t)return e;e=e.slice(0,Math.ceil(t/32));var i=e.length;return t&=31,0<i&&t&&(e[i-1]=sjcl.bitArray.partial(t,e[i-1]&2147483648>>t-1,1)),e},partial:function partial(e,t,i){return 32===e?t:(i?0|t:t<<32-e)+1099511627776*e},getPartial:function getPartial(e){return Math.round(e/1099511627776)||32},equal:function equal(e,t){if(sjcl.bitArray.bitLength(e)!==sjcl.bitArray.bitLength(t))return!1;var r,a=0;for(r=0;r<e.length;r++)a|=e[r]^t[r];return 0==a},_shiftRight:function _shiftRight(e,t,r,a){var c,n,o=0;for(void 0===a&&(a=[]);32<=t;t-=32)a.push(r),r=0;if(0===t)return a.concat(e);for(c=0;c<e.length;c++)a.push(r|e[c]>>>t),r=e[c]<<32-t;return o=e.length?e[e.length-1]:0,n=sjcl.bitArray.getPartial(o),a.push(sjcl.bitArray.partial(31&t+n,32<t+n?r:a.pop(),1)),a},_xor4:function _xor4(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function byteswapM(e){var t,r;for(t=0;t<e.length;++t)r=e[t],e[t]=r>>>24|65280&r>>>8|(65280&r)<<8|r<<24;return e}},sjcl.codec.utf8String={fromBits:function fromBits(e){var t,r,a="",c=sjcl.bitArray.bitLength(e);for(t=0;t<c/8;t++)0==(3&t)&&(r=e[t/4]),a+=String.fromCharCode(r>>>8>>>8>>>8),r<<=8;return decodeURIComponent(escape(a))},toBits:function toBits(e){e=unescape(encodeURIComponent(e));var t,r=[],a=0;for(t=0;t<e.length;t++)a=a<<8|e.charCodeAt(t),3==(3&t)&&(r.push(a),a=0);return 3&t&&r.push(sjcl.bitArray.partial(8*(3&t),a)),r}},sjcl.codec.hex={fromBits:function fromBits(e){var t,r="";for(t=0;t<e.length;t++)r+=((0|e[t])+0xF00000000000).toString(16).substr(4);return r.substr(0,sjcl.bitArray.bitLength(e)/4)},toBits:function toBits(e){var t,r,a=[];for(e=e.replace(/\s|0x/g,""),r=e.length,e+="00000000",t=0;t<e.length;t+=8)a.push(0^parseInt(e.substr(t,8),16));return sjcl.bitArray.clamp(a,4*r)}},sjcl.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function fromBits(e,t,r){var a,n="",o=0,s=sjcl.codec.base64._chars,l=0,d=sjcl.bitArray.bitLength(e);for(r&&(s=s.substr(0,62)+"-_"),a=0;6*n.length<d;)n+=s.charAt((l^e[a]>>>o)>>>26),6>o?(l=e[a]<<6-o,o+=26,a++):(l<<=6,o-=6);for(;3&n.length&&!t;)n+="=";return n},toBits:function toBits(e,t){e=e.replace(/\s|=/g,"");var r,a,n=[],o=0,s=sjcl.codec.base64._chars,l=0;for(t&&(s=s.substr(0,62)+"-_"),r=0;r<e.length;r++){if(a=s.indexOf(e.charAt(r)),0>a)throw new sjcl.exception.invalid("this isn't base64!");26<o?(o-=26,n.push(l^a>>>o),l=a<<32-o):(o+=6,l^=a<<32-o)}return 56&o&&n.push(sjcl.bitArray.partial(56&o,l,1)),n}},sjcl.codec.base64url={fromBits:function fromBits(e){return sjcl.codec.base64.fromBits(e,1,1)},toBits:function toBits(e){return sjcl.codec.base64.toBits(e,1)}},sjcl.hash.sha256=function(e){this._key[0]||this._precompute(),e?(this._h=e._h.slice(0),this._buffer=e._buffer.slice(0),this._length=e._length):this.reset()},sjcl.hash.sha256.hash=function(e){return new sjcl.hash.sha256().update(e).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function reset(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function update(e){"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e));var t,r=this._buffer=sjcl.bitArray.concat(this._buffer,e),a=this._length,n=this._length=a+sjcl.bitArray.bitLength(e);if(9007199254740991<n)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){var o=new Uint32Array(r),c=0;for(t=512+a-(511&512+a);t<=n;t+=512)this._block(o.subarray(16*c,16*(c+1))),c+=1;r.splice(0,16*c)}else for(t=512+a-(511&512+a);t<=n;t+=512)this._block(r.splice(0,16));return this},finalize:function finalize(){var e,t=this._buffer,r=this._h;for(t=sjcl.bitArray.concat(t,[sjcl.bitArray.partial(1,1)]),e=t.length+2;15&e;e++)t.push(0);for(t.push(Math.floor(this._length/4294967296)),t.push(0|this._length);t.length;)this._block(t.splice(0,16));return this.reset(),r},_init:[],_key:[],_precompute:function _precompute(){function e(e){return 0|4294967296*(e-Math.floor(e))}for(var t,r,a=Math.pow,c=0,n=2;64>c;n++){for(r=!0,t=2;t*t<=n;t++)if(0==n%t){r=!1;break}r&&(8>c&&(this._init[c]=e(a(n,1/2))),this._key[c]=e(a(n,1/3)),c++)}},_block:function _block(e){var t,r,c,n,o=this._h,s=this._key,l=o[0],d=o[1],u=o[2],m=o[3],f=o[4],p=o[5],h=o[6],_=o[7];for(t=0;64>t;t++)16>t?r=e[t]:(c=e[15&t+1],n=e[15&t+14],r=e[15&t]=0|(c>>>7^c>>>18^c>>>3^c<<25^c<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+e[15&t]+e[15&t+9]),r=r+_+(f>>>6^f>>>11^f>>>25^f<<26^f<<21^f<<7)+(h^f&(p^h))+s[t],_=h,h=p,p=f,f=0|m+r,m=u,u=d,d=l,l=0|r+(d&u^m&(d^u))+(d>>>2^d>>>13^d>>>22^d<<30^d<<19^d<<10);o[0]=0|o[0]+l,o[1]=0|o[1]+d,o[2]=0|o[2]+u,o[3]=0|o[3]+m,o[4]=0|o[4]+f,o[5]=0|o[5]+p,o[6]=0|o[6]+h,o[7]=0|o[7]+_}},sjcl.mode.ccm={name:"ccm",_progressListeners:[],listenProgress:function listenProgress(e){sjcl.mode.ccm._progressListeners.push(e)},unListenProgress:function unListenProgress(e){var t=sjcl.mode.ccm._progressListeners.indexOf(e);-1<t&&sjcl.mode.ccm._progressListeners.splice(t,1)},_callProgressListener:function _callProgressListener(e){var t,r=sjcl.mode.ccm._progressListeners.slice();for(t=0;t<r.length;t+=1)r[t](e)},encrypt:function encrypt(e,t,i,r,a){var c,n,o=t.slice(0),s=sjcl.bitArray,l=s.bitLength(i)/8,d=s.bitLength(o)/8;if(a=a||64,r=r||[],7>l)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(c=2;4>c&&d>>>8*c;c++);return c<15-l&&(c=15-l),i=s.clamp(i,8*(15-c)),n=sjcl.mode.ccm._computeTag(e,t,i,r,a,c),o=sjcl.mode.ccm._ctrMode(e,o,i,n,a,c),s.concat(o.data,o.tag)},decrypt:function decrypt(e,t,i,r,a){a=a||64,r=r||[];var c,n,o=sjcl.bitArray,s=o.bitLength(i)/8,l=o.bitLength(t),d=o.clamp(t,l-a),u=o.bitSlice(t,l-a);if(l=(l-a)/8,7>s)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(c=2;4>c&&l>>>8*c;c++);if(c<15-s&&(c=15-s),i=o.clamp(i,8*(15-c)),d=sjcl.mode.ccm._ctrMode(e,d,i,u,a,c),n=sjcl.mode.ccm._computeTag(e,d.data,i,r,a,c),!o.equal(d.tag,n))throw new sjcl.exception.corrupt("ccm: tag doesn't match");return d.data},_macAdditionalData:function _macAdditionalData(e,t,r,a,c,n){var o,s,l,d=[],u=sjcl.bitArray,m=u._xor4;if(o=[u.partial(8,(t.length?64:0)|a-2<<2|n-1)],o=u.concat(o,r),o[3]|=c,o=e.encrypt(o),t.length)for(s=u.bitLength(t)/8,65279>=s?d=[u.partial(16,s)]:4294967295>=s&&(d=u.concat([u.partial(16,65534)],[s])),d=u.concat(d,t),l=0;l<d.length;l+=4)o=e.encrypt(m(o,d.slice(l,l+4).concat([0,0,0])));return o},_computeTag:function _computeTag(e,t,r,a,c,n){var o,s,l=sjcl.bitArray,d=l._xor4;if(c/=8,c%2||4>c||16<c)throw new sjcl.exception.invalid("ccm: invalid tag length");if(4294967295<a.length||4294967295<t.length)throw new sjcl.exception.bug("ccm: can't deal with 4GiB or more data");for(o=sjcl.mode.ccm._macAdditionalData(e,a,r,c,l.bitLength(t)/8,n),s=0;s<t.length;s+=4)o=e.encrypt(d(o,t.slice(s,s+4).concat([0,0,0])));return l.clamp(o,8*c)},_ctrMode:function _ctrMode(e,t,r,a,c,o){var s,d,u,m=sjcl.bitArray,b=m._xor4,f=t.length,l=m.bitLength(t),h=f/50,_=h;if(u=m.concat([m.partial(8,o-1)],r).concat([0,0,0]).slice(0,4),a=m.bitSlice(b(a,e.encrypt(u)),0,c),!f)return{tag:a,data:[]};for(d=0;d<f;d+=4)d>h&&(sjcl.mode.ccm._callProgressListener(d/f),h+=_),u[3]++,s=e.encrypt(u),t[d]^=s[0],t[d+1]^=s[1],t[d+2]^=s[2],t[d+3]^=s[3];return{tag:a,data:m.clamp(t,l)}}},sjcl.misc.hmac=function(e,t){this._hash=t=t||sjcl.hash.sha256;var r,a=[[],[]],c=t.prototype.blockSize/32;for(this._baseHash=[new t,new t],e.length>c&&(e=t.hash(e)),r=0;r<c;r++)a[0][r]=909522486^e[r],a[1][r]=1549556828^e[r];this._baseHash[0].update(a[0]),this._baseHash[1].update(a[1]),this._resultHash=new t(this._baseHash[0])},sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(e){if(!this._updated)return this.update(e),this.digest(e);throw new sjcl.exception.invalid("encrypt on already updated hmac called!")},sjcl.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]),this._updated=!1},sjcl.misc.hmac.prototype.update=function(e){this._updated=!0,this._resultHash.update(e)},sjcl.misc.hmac.prototype.digest=function(){var e=this._resultHash.finalize(),t=new this._hash(this._baseHash[1]).update(e).finalize();return this.reset(),t},sjcl.misc.pbkdf2=function(e,t,r,a,c){if(r=r||1e4,0>a||0>r)throw new sjcl.exception.invalid("invalid params to pbkdf2");"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t)),c=c||sjcl.misc.hmac;var n,o,s,l,d,m=new c(e),f=[],p=sjcl.bitArray;for(d=1;32*f.length<(a||1);d++){for(n=o=m.encrypt(p.concat(t,[d])),s=1;s<r;s++)for(o=m.encrypt(o),l=0;l<o.length;l++)n[l]^=o[l];f=f.concat(n)}return a&&(f=p.clamp(f,a)),f},sjcl.prng=function(e){this._pools=[new sjcl.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=e,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},sjcl.prng.prototype={randomWords:function randomWords(e,t){var r,a,c=[],n=this.isReady(t);if(n===this._NOT_READY)throw new sjcl.exception.notReady("generator isn't seeded");else n&this._REQUIRES_RESEED&&this._reseedFromPools(!(n&this._READY));for(r=0;r<e;r+=4)0==(r+1)%this._MAX_WORDS_PER_BURST&&this._gate(),a=this._gen4words(),c.push(a[0],a[1],a[2],a[3]);return this._gate(),c.slice(0,e)},setDefaultParanoia:function setDefaultParanoia(e,t){if(0===e&&"Setting paranoia=0 will ruin your security; use it only for testing"!==t)throw new sjcl.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this._defaultParanoia=e},addEntropy:function addEntropy(e,r,a){a=a||"user";var c,n,o,s,l=new Date().valueOf(),t=this._robins[a],d=this.isReady(),u=0;switch(c=this._collectorIds[a],void 0===c&&(c=this._collectorIds[a]=this._collectorIdNext++),void 0===t&&(t=this._robins[a]=0),this._robins[a]=(this._robins[a]+1)%this._pools.length,(0,_typeof2["default"])(e)){case"number":void 0===r&&(r=1),this._pools[t].update([c,this._eventId++,1,r,l,1,0|e]);break;case"object":if(s=Object.prototype.toString.call(e),"[object Uint32Array]"===s){for(o=[],n=0;n<e.length;n++)o.push(e[n]);e=o}else for("[object Array]"!==s&&(u=1),n=0;n<e.length&&!u;n++)"number"!=typeof e[n]&&(u=1);if(!u){if(void 0===r)for(r=0,n=0;n<e.length;n++)for(o=e[n];0<o;)r++,o>>>=1;this._pools[t].update([c,this._eventId++,2,r,l,e.length].concat(e))}break;case"string":void 0===r&&(r=e.length),this._pools[t].update([c,this._eventId++,3,r,l,e.length]),this._pools[t].update(e);break;default:u=1;}if(u)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[t]+=r,this._poolStrength+=r,d===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function isReady(e){var t=this._PARANOIA_LEVELS[e===void 0?this._defaultParanoia:e];return this._strength&&this._strength>=t?this._poolEntropy[0]>this._BITS_PER_RESEED&&new Date().valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=t?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function getProgress(e){var t=this._PARANOIA_LEVELS[e?e:this._defaultParanoia];return this._strength>=t?1:this._poolStrength>t?1:this._poolStrength/t},startCollectors:function startCollectors(){if(!this._collectorsStarted){if(this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector),touchCollector:this._bind(this._touchCollector)},window.addEventListener)window.addEventListener("load",this._eventListener.loadTimeCollector,!1),window.addEventListener("mousemove",this._eventListener.mouseCollector,!1),window.addEventListener("keypress",this._eventListener.keyboardCollector,!1),window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.addEventListener("touchmove",this._eventListener.touchCollector,!1);else if(document.attachEvent)document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector),document.attachEvent("keypress",this._eventListener.keyboardCollector);else throw new sjcl.exception.bug("can't attach event");this._collectorsStarted=!0}},stopCollectors:function stopCollectors(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._eventListener.loadTimeCollector,!1),window.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),window.removeEventListener("keypress",this._eventListener.keyboardCollector,!1),window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.removeEventListener("touchmove",this._eventListener.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),document.detachEvent("keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1)},addEventListener:function addEventListener(e,t){this._callbacks[e][this._callbackI++]=t},removeEventListener:function removeEventListener(e,t){var r,a,c=this._callbacks[e],n=[];for(a in c)c.hasOwnProperty(a)&&c[a]===t&&n.push(a);for(r=0;r<n.length;r++)a=n[r],delete c[a]},_bind:function _bind(e){var t=this;return function(){e.apply(t,arguments)}},_gen4words:function _gen4words(){for(var e=0;4>e&&(this._counter[e]=0|this._counter[e]+1,!this._counter[e]);e++);return this._cipher.encrypt(this._counter)},_gate:function _gate(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new sjcl.cipher.aes(this._key)},_reseed:function _reseed(e){this._key=sjcl.hash.sha256.hash(this._key.concat(e)),this._cipher=new sjcl.cipher.aes(this._key);for(var t=0;4>t&&(this._counter[t]=0|this._counter[t]+1,!this._counter[t]);t++);},_reseedFromPools:function _reseedFromPools(e){var t,r=[],a=0;for(this._nextReseed=r[0]=new Date().valueOf()+this._MILLISECONDS_PER_RESEED,t=0;16>t;t++)r.push(0|4294967296*Math.random());for(t=0;t<this._pools.length&&(r=r.concat(this._pools[t].finalize()),a+=this._poolEntropy[t],this._poolEntropy[t]=0,e||!(this._reseedCount&1<<t));t++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new sjcl.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=a,a>this._strength&&(this._strength=a),this._reseedCount++,this._reseed(r)},_keyboardCollector:function _keyboardCollector(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function _mouseCollector(e){var t,i;try{t=e.x||e.clientX||e.offsetX||0,i=e.y||e.clientY||e.offsetY||0}catch(e){t=0,i=0}0!=t&&0!=i&&this.addEntropy([t,i],2,"mouse"),this._addCurrentTimeToEntropy(0)},_touchCollector:function _touchCollector(e){var t=e.touches[0]||e.changedTouches[0],i=t.pageX||t.clientX,r=t.pageY||t.clientY;this.addEntropy([i,r],1,"touch"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function _loadTimeCollector(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function _addCurrentTimeToEntropy(e){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?this.addEntropy(window.performance.now(),e,"loadtime"):this.addEntropy(new Date().valueOf(),e,"loadtime")},_accelerometerCollector:function _accelerometerCollector(e){var t=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z;if(window.orientation){var i=window.orientation;"number"==typeof i&&this.addEntropy(i,1,"accelerometer")}t&&this.addEntropy(t,2,"accelerometer"),this._addCurrentTimeToEntropy(0)},_fireEvent:function _fireEvent(e,t){var i,r=sjcl.random._callbacks[e],a=[];for(i in r)r.hasOwnProperty(i)&&a.push(r[i]);for(i=0;i<a.length;i++)a[i](t)}},sjcl.random=new sjcl.prng(6),function(){function e(){try{return require("crypto")}catch(t){return null}}try{var t,i,r;if("undefined"!=typeof module&&module.exports&&(i=e())&&i.randomBytes)t=i.randomBytes(128),t=new Uint32Array(new Uint8Array(t).buffer),sjcl.random.addEntropy(t,1024,"crypto.randomBytes");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(r=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(r);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(r);else return;sjcl.random.addEntropy(r,1024,"crypto.getRandomValues")}else;}catch(t){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(t))}}(),sjcl.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},_encrypt:function _encrypt(e,t,i,r){i=i||{},r=r||{};var a,c,n,o=sjcl.json,s=o._add({iv:sjcl.random.randomWords(4,0)},o.defaults);if(o._add(s,i),n=s.adata,"string"==typeof s.salt&&(s.salt=sjcl.codec.base64.toBits(s.salt)),"string"==typeof s.iv&&(s.iv=sjcl.codec.base64.toBits(s.iv)),!sjcl.mode[s.mode]||!sjcl.cipher[s.cipher]||"string"==typeof e&&100>=s.iter||64!==s.ts&&96!==s.ts&&128!==s.ts||128!==s.ks&&192!==s.ks&&256!==s.ks||2>s.iv.length||4<s.iv.length)throw new sjcl.exception.invalid("json encrypt: invalid parameters");return"string"==typeof e?(a=sjcl.misc.cachedPbkdf2(e,s),e=a.key.slice(0,s.ks/32),s.salt=a.salt):sjcl.ecc&&e instanceof sjcl.ecc.elGamal.publicKey&&(a=e.kem(),s.kemtag=a.tag,e=a.key.slice(0,s.ks/32)),"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t)),"string"==typeof n&&(s.adata=n=sjcl.codec.utf8String.toBits(n)),c=new sjcl.cipher[s.cipher](e),o._add(r,s),r.key=e,s.ct="ccm"===s.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&t instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.encrypt(c,t,s.iv,n,s.ts):sjcl.mode[s.mode].encrypt(c,t,s.iv,n,s.ts),s},encrypt:function encrypt(){var e=sjcl.json,t=e._encrypt.apply(e,arguments);return e.encode(t)},_decrypt:function _decrypt(e,t,i,r){i=i||{},r=r||{};var a,c,n,o=sjcl.json,s=o._add(o._add(o._add({},o.defaults),t),i,!0),l=s.adata;if("string"==typeof s.salt&&(s.salt=sjcl.codec.base64.toBits(s.salt)),"string"==typeof s.iv&&(s.iv=sjcl.codec.base64.toBits(s.iv)),!sjcl.mode[s.mode]||!sjcl.cipher[s.cipher]||"string"==typeof e&&100>=s.iter||64!==s.ts&&96!==s.ts&&128!==s.ts||128!==s.ks&&192!==s.ks&&256!==s.ks||!s.iv||2>s.iv.length||4<s.iv.length)throw new sjcl.exception.invalid("json decrypt: invalid parameters");return"string"==typeof e?(c=sjcl.misc.cachedPbkdf2(e,s),e=c.key.slice(0,s.ks/32),s.salt=c.salt):sjcl.ecc&&e instanceof sjcl.ecc.elGamal.secretKey&&(e=e.unkem(sjcl.codec.base64.toBits(s.kemtag)).slice(0,s.ks/32)),"string"==typeof l&&(l=sjcl.codec.utf8String.toBits(l)),n=new sjcl.cipher[s.cipher](e),a="ccm"===s.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&s.ct instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.decrypt(n,s.ct,s.iv,s.tag,l,s.ts):sjcl.mode[s.mode].decrypt(n,s.ct,s.iv,l,s.ts),o._add(r,s),r.key=e,1===i.raw?a:sjcl.codec.utf8String.fromBits(a)},decrypt:function decrypt(e,t,i,r){var a=sjcl.json;return a._decrypt(e,a.decode(t),i,r)},encode:function encode(e){var t,r="{",a="";for(t in e)if(e.hasOwnProperty(t)){if(!t.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");switch(r+=a+"\""+t+"\":",a=",",(0,_typeof2["default"])(e[t])){case"number":case"boolean":r+=e[t];break;case"string":r+="\""+escape(e[t])+"\"";break;case"object":r+="\""+sjcl.codec.base64.fromBits(e[t],0)+"\"";break;default:throw new sjcl.exception.bug("json encode: unsupported type");}}return r+"}"},decode:function decode(e){if(e=e.replace(/\s/g,""),!e.match(/^\{.*\}$/))throw new sjcl.exception.invalid("json decode: this isn't json!");var t,r,c=e.replace(/^\{|\}$/g,"").split(/,/),a={};for(t=0;t<c.length;t++){if(!(r=c[t].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new sjcl.exception.invalid("json decode: this isn't json!");null==r[3]?null==r[4]?null!=r[5]&&(a[r[2]]="true"===r[5]):a[r[2]]=r[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(r[4]):unescape(r[4]):a[r[2]]=parseInt(r[3],10)}return a},_add:function _add(e,t,r){if(void 0===e&&(e={}),void 0===t)return e;for(var a in t)if(t.hasOwnProperty(a)){if(r&&void 0!==e[a]&&e[a]!==t[a])throw new sjcl.exception.invalid("required parameter overridden");e[a]=t[a]}return e},_subtract:function _subtract(e,t){var r,a={};for(r in e)e.hasOwnProperty(r)&&e[r]!==t[r]&&(a[r]=e[r]);return a},_filter:function _filter(e,t){var r,a={};for(r=0;r<t.length;r++)void 0!==e[t[r]]&&(a[t[r]]=e[t[r]]);return a}},sjcl.encrypt=sjcl.json.encrypt,sjcl.decrypt=sjcl.json.decrypt,sjcl.misc._pbkdf2Cache={},sjcl.misc.cachedPbkdf2=function(e,t){var i,r,a,n,o=sjcl.misc._pbkdf2Cache;return t=t||{},n=t.iter||1e3,r=o[e]=o[e]||{},i=r[n]=r[n]||{firstSalt:t.salt&&t.salt.length?t.salt.slice(0):sjcl.random.randomWords(2,0)},a=void 0===t.salt?i.firstSalt:t.salt,i[a]=i[a]||sjcl.misc.pbkdf2(e,a,t.iter),{key:i[a].slice(0),salt:a.slice(0)}},sjcl.bn=function(e){this.initWith(e)},sjcl.bn.prototype={radix:24,maxMul:8,_class:sjcl.bn,copy:function copy(){return new this._class(this)},initWith:function initWith(e){var t,r=0;switch((0,_typeof2["default"])(e)){case"object":this.limbs=e.limbs.slice(0);break;case"number":this.limbs=[e],this.normalize();break;case"string":for(e=e.replace(/^0x/,""),this.limbs=[],t=this.radix/4,r=0;r<e.length;r+=t)this.limbs.push(parseInt(e.substring(Math.max(e.length-r-t,0),e.length-r),16));break;default:this.limbs=[0];}return this},equals:function equals(e){"number"==typeof e&&(e=new this._class(e));var t,r=0;for(this.fullReduce(),e.fullReduce(),t=0;t<this.limbs.length||t<e.limbs.length;t++)r|=this.getLimb(t)^e.getLimb(t);return 0==r},getLimb:function getLimb(e){return e>=this.limbs.length?0:this.limbs[e]},greaterEquals:function greaterEquals(e){"number"==typeof e&&(e=new this._class(e));var t,r,c,n=0,o=0;for(t=Math.max(this.limbs.length,e.limbs.length)-1;0<=t;t--)r=this.getLimb(t),c=e.getLimb(t),o|=c-r&~n,n|=r-c&~o;return(o|~n)>>>31},toString:function toString(){this.fullReduce();var e,t,r="",a=this.limbs;for(e=0;e<this.limbs.length;e++){for(t=a[e].toString(16);e<this.limbs.length-1&&6>t.length;)t="0"+t;r=t+r}return"0x"+r},addM:function addM(e){"object"!==(0,_typeof2["default"])(e)&&(e=new this._class(e));var t,r=this.limbs,a=e.limbs;for(t=r.length;t<a.length;t++)r[t]=0;for(t=0;t<a.length;t++)r[t]+=a[t];return this},doubleM:function doubleM(){var e,t,a=0,c=this.radix,r=this.radixMask,n=this.limbs;for(e=0;e<n.length;e++)t=n[e],t=t+t+a,n[e]=t&r,a=t>>c;return a&&n.push(a),this},halveM:function halveM(){var e,t,a=0,c=this.radix,r=this.limbs;for(e=r.length-1;0<=e;e--)t=r[e],r[e]=t+a>>1,a=(1&t)<<c;return r[r.length-1]||r.pop(),this},subM:function subM(e){"object"!==(0,_typeof2["default"])(e)&&(e=new this._class(e));var t,r=this.limbs,a=e.limbs;for(t=r.length;t<a.length;t++)r[t]=0;for(t=0;t<a.length;t++)r[t]-=a[t];return this},mod:function mod(e){var t=!this.greaterEquals(new sjcl.bn(0));e=new sjcl.bn(e).normalize();var i=new sjcl.bn(this).normalize(),r=0;for(t&&(i=new sjcl.bn(0).subM(i).normalize());i.greaterEquals(e);r++)e.doubleM();for(t&&(i=e.sub(i).normalize());0<r;r--)e.halveM(),i.greaterEquals(e)&&i.subM(e).normalize();return i.trim()},inverseMod:function inverseMod(e){var t,r,c=new sjcl.bn(1),n=new sjcl.bn(0),o=new sjcl.bn(this),s=new sjcl.bn(e),l=1;if(!(1&e.limbs[0]))throw new sjcl.exception.invalid("inverseMod: p must be odd");do for(1&o.limbs[0]&&(!o.greaterEquals(s)&&(t=o,o=s,s=t,t=c,c=n,n=t),o.subM(s),o.normalize(),!c.greaterEquals(n)&&c.addM(e),c.subM(n)),o.halveM(),1&c.limbs[0]&&c.addM(e),c.normalize(),c.halveM(),r=l=0;r<o.limbs.length;r++)l|=o.limbs[r];while(l);if(!s.equals(1))throw new sjcl.exception.invalid("inverseMod: p and x must be relatively prime");return n},add:function add(e){return this.copy().addM(e)},sub:function sub(e){return this.copy().subM(e)},mul:function mul(e){"number"==typeof e?e=new this._class(e):e.normalize(),this.normalize();var t,r,n,o=this.limbs,a=e.limbs,s=o.length,l=a.length,d=new this._class,u=d.limbs,c=this.maxMul;for(t=0;t<this.limbs.length+e.limbs.length+1;t++)u[t]=0;for(t=0;t<s;t++){for(n=o[t],r=0;r<l;r++)u[t+r]+=n*a[r];--c||(c=this.maxMul,d.cnormalize())}return d.cnormalize().reduce()},square:function square(){return this.mul(this)},power:function power(e){e=new sjcl.bn(e).normalize().trim().limbs;var t,r,a=new this._class(1),c=this;for(t=0;t<e.length;t++)for(r=0;r<this.radix&&(e[t]&1<<r&&(a=a.mul(c)),t!=e.length-1||0!=e[t]>>r+1);r++)c=c.square();return a},mulmod:function mulmod(e,t){return this.mod(t).mul(e.mod(t)).mod(t)},powermod:function powermod(e,t){if(e=new sjcl.bn(e),t=new sjcl.bn(t),1==(1&t.limbs[0])){var r=this.montpowermod(e,t);if(!1!=r)return r}var a,c,n=e.normalize().trim().limbs,o=new this._class(1),s=this;for(a=0;a<n.length;a++)for(c=0;c<this.radix&&(n[a]&1<<c&&(o=o.mulmod(s,t)),a!=n.length-1||0!=n[a]>>c+1);c++)s=s.mulmod(s,t);return o},montpowermod:function montpowermod(e,t){e=new sjcl.bn(e).normalize().trim(),t=new sjcl.bn(t);var r,a,c,n,o,d=this.radix,u=new this._class(1),m=this.copy(),b=e.bitLength();for(c=new sjcl.bn({limbs:t.copy().normalize().trim().limbs.map(function(){return 0})}),n=this.radix;0<n;n--)if(1==(1&t.limbs[t.limbs.length-1]>>n)){c.limbs[c.limbs.length-1]=1<<n;break}if(0==b)return this;o=18>b?1:48>b?3:144>b?4:768>b?5:6;for(var f=c.copy(),p=t.copy(),_=new sjcl.bn(1),g=new sjcl.bn(0),y=c.copy();y.greaterEquals(1);)y.halveM(),0==(1&_.limbs[0])?(_.halveM(),g.halveM()):(_.addM(p),_.halveM(),g.halveM(),g.addM(f));_=_.normalize(),g=g.normalize(),f.doubleM();var v=f.mulmod(f,t);if(!f.mul(_).sub(t.mul(g)).equals(1))return!1;var E=function(e){return B(e,v)},B=function(e,i){var r,a,o,s,l=(1<<n+1)-1;for(a=e.mul(i),o=a.mul(g),o.limbs=o.limbs.slice(0,c.limbs.length),o.limbs.length==c.limbs.length&&(o.limbs[c.limbs.length-1]&=l),o=o.mul(t),s=a.add(o).normalize().trim(),s.limbs=s.limbs.slice(c.limbs.length-1),r=0;r<s.limbs.length;r++)0<r&&(s.limbs[r-1]|=(s.limbs[r]&l)<<d-n-1),s.limbs[r]>>=n+1;return s.greaterEquals(t)&&s.subM(t),s};m=E(m),u=E(u);var F,k={},A=(1<<o-1)-1;for(k[1]=m.copy(),k[2]=B(m,m),F=1;F<=A;F++)k[2*F+1]=B(k[2*F-1],k[2]);var L=function(e,t){var i=t%e.radix;return(e.limbs[Math.floor(t/e.radix)]&1<<i)>>i};for(r=e.bitLength()-1;0<=r;)if(0==L(e,r))u=B(u,u),--r;else{for(var C=r-o+1;0==L(e,C);)C++;var S=0;for(a=C;a<=r;a++)S+=L(e,a)<<a-C,u=B(u,u);u=B(u,k[S]),r=C-1}return function montOut(e){return B(e,1)}(u)},trim:function trim(){var e,t=this.limbs;do e=t.pop();while(t.length&&0===e);return t.push(e),this},reduce:function reduce(){return this},fullReduce:function fullReduce(){return this.normalize()},normalize:function normalize(){var e,t,r,a=0,c=this.placeVal,n=this.ipv,o=this.limbs,s=o.length,d=this.radixMask;for(e=0;e<s||0!==a&&-1!==a;e++)t=(o[e]||0)+a,r=o[e]=t&d,a=(t-r)*n;return-1==a&&(o[e-1]-=c),this.trim(),this},cnormalize:function cnormalize(){var e,t,r,a=0,c=this.ipv,n=this.limbs,o=n.length,s=this.radixMask;for(e=0;e<o-1;e++)t=n[e]+a,r=n[e]=t&s,a=(t-r)*c;return n[e]+=a,this},toBits:function toBits(t){this.fullReduce(),t=t||this.exponent||this.bitLength();var r=Math.floor((t-1)/24),a=sjcl.bitArray,c=(-8&t+7)%this.radix||this.radix,e=[a.partial(c,this.getLimb(r))];for(r--;0<=r;r--)e=a.concat(e,[a.partial(Math.min(this.radix,t),this.getLimb(r))]),t-=this.radix;return e},bitLength:function bitLength(){this.fullReduce();for(var e=this.radix*(this.limbs.length-1),t=this.limbs[this.limbs.length-1];t;t>>>=1)e++;return-8&e+7}},sjcl.bn.fromBits=function(i){var r=this,a=new r,c=[],n=sjcl.bitArray,o=this.prototype,t=Math.min(this.bitLength||4294967296,n.bitLength(i)),s=t%o.radix||o.radix;for(c[0]=n.extract(i,0,s);s<t;s+=o.radix)c.unshift(n.extract(i,s,o.radix));return a.limbs=c,a},sjcl.bn.prototype.ipv=1/(sjcl.bn.prototype.placeVal=Math.pow(2,sjcl.bn.prototype.radix)),sjcl.bn.prototype.radixMask=(1<<sjcl.bn.prototype.radix)-1,sjcl.bn.pseudoMersennePrime=function(e,t){function r(e){this.initWith(e)}var a,c,n,o=Math.pow,s=Math.floor,l=r.prototype=new sjcl.bn;for(n=l.modOffset=Math.ceil(c=e/l.radix),l.exponent=e,l.offset=[],l.factor=[],l.minOffset=n,l.fullMask=0,l.fullOffset=[],l.fullFactor=[],l.modulus=r.modulus=new sjcl.bn(o(2,e)),l.fullMask=0|-o(2,e%l.radix),a=0;a<t.length;a++)l.offset[a]=s(t[a][0]/l.radix-c),l.fullOffset[a]=s(t[a][0]/l.radix)-n+1,l.factor[a]=t[a][1]*o(1/2,e-t[a][0]+l.offset[a]*l.radix),l.fullFactor[a]=t[a][1]*o(1/2,e-t[a][0]+l.fullOffset[a]*l.radix),l.modulus.addM(new sjcl.bn(o(2,t[a][0])*t[a][1])),l.minOffset=Math.min(l.minOffset,-l.offset[a]);return l._class=r,l.modulus.cnormalize(),l.reduce=function(){var e,t,r,a,c=this.modOffset,n=this.limbs,o=this.offset,s=this.offset.length,d=this.factor;for(e=this.minOffset;n.length>c;){for(r=n.pop(),a=n.length,t=0;t<s;t++)n[a+o[t]]-=d[t]*r;e--,e||(n.push(0),this.cnormalize(),e=this.minOffset)}return this.cnormalize(),this},l._strongReduce=-1===l.fullMask?l.reduce:function(){var e,t,r=this.limbs,a=r.length-1;if(this.reduce(),a==this.modOffset-1){for(t=r[a]&this.fullMask,r[a]-=t,e=0;e<this.fullOffset.length;e++)r[a+this.fullOffset[e]]-=this.fullFactor[e]*t;this.normalize()}},l.fullReduce=function(){var e,t;for(this._strongReduce(),this.addM(this.modulus),this.addM(this.modulus),this.normalize(),this._strongReduce(),t=this.limbs.length;t<this.modOffset;t++)this.limbs[t]=0;for(e=this.greaterEquals(this.modulus),t=0;t<this.limbs.length;t++)this.limbs[t]-=this.modulus.limbs[t]*e;return this.cnormalize(),this},l.inverse=function(){return this.power(this.modulus.sub(2))},r.fromBits=sjcl.bn.fromBits,r};var sbp=sjcl.bn.pseudoMersennePrime;sjcl.bn.prime={p127:sbp(127,[[0,-1]]),p25519:sbp(255,[[0,-19]]),p192k:sbp(192,[[32,-1],[12,-1],[8,-1],[7,-1],[6,-1],[3,-1],[0,-1]]),p224k:sbp(224,[[32,-1],[12,-1],[11,-1],[9,-1],[7,-1],[4,-1],[1,-1],[0,-1]]),p256k:sbp(256,[[32,-1],[9,-1],[8,-1],[7,-1],[6,-1],[4,-1],[0,-1]]),p192:sbp(192,[[0,-1],[64,-1]]),p224:sbp(224,[[0,1],[96,-1]]),p256:sbp(256,[[0,-1],[96,1],[192,1],[224,-1]]),p384:sbp(384,[[0,-1],[32,1],[96,-1],[128,-1]]),p521:sbp(521,[[0,-1]])},sjcl.bn.random=function(e,t){var r=Math.floor;"object"!==(0,_typeof2["default"])(e)&&(e=new sjcl.bn(e));for(var a,c,n=e.limbs.length,o=e.limbs[n-1]+1,s=new sjcl.bn;;){do a=sjcl.random.randomWords(n,t),0>a[n-1]&&(a[n-1]+=4294967296);while(r(a[n-1]/o)===r(4294967296/o));for(a[n-1]%=o,c=0;c<n-1;c++)a[c]&=e.radixMask;if(s.limbs=a,!s.greaterEquals(e))return s}},sjcl.ecc={},sjcl.ecc.point=function(e,t,i){t===void 0?this.isIdentity=!0:(t instanceof sjcl.bn&&(t=new e.field(t)),i instanceof sjcl.bn&&(i=new e.field(i)),this.x=t,this.y=i,this.isIdentity=!1),this.curve=e},sjcl.ecc.point.prototype={toJac:function toJac(){return new sjcl.ecc.pointJac(this.curve,this.x,this.y,new this.curve.field(1))},mult:function mult(e){return this.toJac().mult(e,this).toAffine()},mult2:function mult2(e,t,i){return this.toJac().mult2(e,this,t,i).toAffine()},multiples:function multiples(){var e,t,r;if(this._multiples===void 0)for(r=this.toJac().doubl(),e=this._multiples=[new sjcl.ecc.point(this.curve),this,r.toAffine()],t=3;16>t;t++)r=r.add(this),e.push(r.toAffine());return this._multiples},negate:function negate(){var e=new this.curve.field(0).sub(this.y).normalize().reduce();return new sjcl.ecc.point(this.curve,this.x,e)},isValid:function isValid(){return this.y.square().equals(this.curve.b.add(this.x.mul(this.curve.a.add(this.x.square()))))},toBits:function toBits(){return sjcl.bitArray.concat(this.x.toBits(),this.y.toBits())}},sjcl.ecc.pointJac=function(e,t,i,r){t===void 0?this.isIdentity=!0:(this.x=t,this.y=i,this.z=r,this.isIdentity=!1),this.curve=e},sjcl.ecc.pointJac.prototype={add:function add(e){var t,i,r,a,n,o,s,l,u,m,b,f=this;if(f.curve!==e.curve)throw new sjcl.exception.invalid("sjcl.ecc.add(): Points must be on the same curve to add them!");return f.isIdentity?e.toJac():e.isIdentity?f:(t=f.z.square(),i=e.x.mul(t).subM(f.x),i.equals(0))?f.y.equals(e.y.mul(t.mul(f.z)))?f.doubl():new sjcl.ecc.pointJac(f.curve):(r=e.y.mul(t.mul(f.z)).subM(f.y),a=i.square(),n=r.square(),o=i.square().mul(i).addM(f.x.add(f.x).mul(a)),s=n.subM(o),l=f.x.mul(a).subM(s).mul(r),u=f.y.mul(i.square().mul(i)),m=l.subM(u),b=f.z.mul(i),new sjcl.ecc.pointJac(this.curve,s,m,b))},doubl:function doubl(){if(this.isIdentity)return this;var e=this.y.square(),t=e.mul(this.x.mul(4)),i=e.square().mul(8),r=this.z.square(),a=this.curve.a.toString()==new sjcl.bn(-3).toString()?this.x.sub(r).mul(3).mul(this.x.add(r)):this.x.square().mul(3).add(r.square().mul(this.curve.a)),c=a.square().subM(t).subM(t),n=t.sub(c).mul(a).subM(i),o=this.y.add(this.y).mul(this.z);return new sjcl.ecc.pointJac(this.curve,c,n,o)},toAffine:function toAffine(){if(this.isIdentity||this.z.equals(0))return new sjcl.ecc.point(this.curve);var e=this.z.inverse(),t=e.square();return new sjcl.ecc.point(this.curve,this.x.mul(t).fullReduce(),this.y.mul(t.mul(e)).fullReduce())},mult:function mult(e,t){"number"==typeof e?e=[e]:e.limbs!==void 0&&(e=e.normalize().limbs);var r,a,c=new sjcl.ecc.point(this.curve).toJac(),n=t.multiples();for(r=e.length-1;0<=r;r--)for(a=sjcl.bn.prototype.radix-4;0<=a;a-=4)c=c.doubl().doubl().doubl().doubl().add(n[15&e[r]>>a]);return c},mult2:function mult2(e,t,r,a){"number"==typeof e?e=[e]:e.limbs!==void 0&&(e=e.normalize().limbs),"number"==typeof r?r=[r]:r.limbs!==void 0&&(r=r.normalize().limbs);var c,n,o,s,l=new sjcl.ecc.point(this.curve).toJac(),d=t.multiples(),u=a.multiples();for(c=Math.max(e.length,r.length)-1;0<=c;c--)for(o=0|e[c],s=0|r[c],n=sjcl.bn.prototype.radix-4;0<=n;n-=4)l=l.doubl().doubl().doubl().doubl().add(d[15&o>>n]).add(u[15&s>>n]);return l},negate:function negate(){return this.toAffine().negate().toJac()},isValid:function isValid(){var e=this.z.square(),t=e.square(),i=t.mul(e);return this.y.square().equals(this.curve.b.mul(i).add(this.x.mul(this.curve.a.mul(t).add(this.x.square()))))}},sjcl.ecc.curve=function(e,t,i,r,a,c){this.field=e,this.r=new sjcl.bn(t),this.a=new e(i),this.b=new e(r),this.G=new sjcl.ecc.point(this,new e(a),new e(c))},sjcl.ecc.curve.prototype.fromBits=function(e){var t=sjcl.bitArray,i=-8&this.field.prototype.exponent+7,r=new sjcl.ecc.point(this,this.field.fromBits(t.bitSlice(e,0,i)),this.field.fromBits(t.bitSlice(e,i,2*i)));if(!r.isValid())throw new sjcl.exception.corrupt("not on the curve!");return r},sjcl.ecc.curves={c192:new sjcl.ecc.curve(sjcl.bn.prime.p192,"0xffffffffffffffffffffffff99def836146bc9b1b4d22831",-3,"0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1","0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012","0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811"),c224:new sjcl.ecc.curve(sjcl.bn.prime.p224,"0xffffffffffffffffffffffffffff16a2e0b8f03e13dd29455c5c2a3d",-3,"0xb4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4","0xb70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21","0xbd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34"),c256:new sjcl.ecc.curve(sjcl.bn.prime.p256,"0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551",-3,"0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b","0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296","0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),c384:new sjcl.ecc.curve(sjcl.bn.prime.p384,"0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973",-3,"0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef","0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7","0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),c521:new sjcl.ecc.curve(sjcl.bn.prime.p521,"0x1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409",-3,"0x051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","0xC6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","0x11839296A789A3BC0045C8A5FB42C7D1BD998F54449579B446817AFBD17273E662C97EE72995EF42640C550B9013FAD0761353C7086A272C24088BE94769FD16650"),k192:new sjcl.ecc.curve(sjcl.bn.prime.p192k,"0xfffffffffffffffffffffffe26f2fc170f69466a74defd8d",0,3,"0xdb4ff10ec057e9ae26b07d0280b7f4341da5d1b1eae06c7d","0x9b2f2f6d9c5628a7844163d015be86344082aa88d95e2f9d"),k224:new sjcl.ecc.curve(sjcl.bn.prime.p224k,"0x010000000000000000000000000001dce8d2ec6184caf0a971769fb1f7",0,5,"0xa1455b334df099df30fc28a169a467e9e47075a90f7e650eb6b7a45c","0x7e089fed7fba344282cafbd6f7e319f7c0b0bd59e2ca4bdb556d61a5"),k256:new sjcl.ecc.curve(sjcl.bn.prime.p256k,"0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",0,7,"0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},sjcl.ecc.curveName=function(e){for(var t in sjcl.ecc.curves)if(sjcl.ecc.curves.hasOwnProperty(t)&&sjcl.ecc.curves[t]===e)return t;throw new sjcl.exception.invalid("no such curve")},sjcl.ecc.deserialize=function(e){if(!e||!e.curve||!sjcl.ecc.curves[e.curve])throw new sjcl.exception.invalid("invalid serialization");if(-1===["elGamal","ecdsa"].indexOf(e.type))throw new sjcl.exception.invalid("invalid type");var t=sjcl.ecc.curves[e.curve];if(e.secretKey){if(!e.exponent)throw new sjcl.exception.invalid("invalid exponent");var i=new sjcl.bn(e.exponent);return new sjcl.ecc[e.type].secretKey(t,i)}if(!e.point)throw new sjcl.exception.invalid("invalid point");var r=t.fromBits(sjcl.codec.hex.toBits(e.point));return new sjcl.ecc[e.type].publicKey(t,r)},sjcl.ecc.basicKey={publicKey:function publicKey(e,t){this._curve=e,this._curveBitLength=e.r.bitLength(),this._point=t instanceof Array?e.fromBits(t):t,this.serialize=function(){var t=sjcl.ecc.curveName(e);return{type:this.getType(),secretKey:!1,point:sjcl.codec.hex.fromBits(this._point.toBits()),curve:t}},this.get=function(){var e=this._point.toBits(),t=sjcl.bitArray.bitLength(e),i=sjcl.bitArray.bitSlice(e,0,t/2),r=sjcl.bitArray.bitSlice(e,t/2);return{x:i,y:r}}},secretKey:function secretKey(e,t){this._curve=e,this._curveBitLength=e.r.bitLength(),this._exponent=t,this.serialize=function(){var t=this.get(),i=sjcl.ecc.curveName(e);return{type:this.getType(),secretKey:!0,exponent:sjcl.codec.hex.fromBits(t),curve:i}},this.get=function(){return this._exponent.toBits()}}},sjcl.ecc.basicKey.generateKeys=function(e){return function(t,i,r){if(t=t||256,"number"==typeof t&&(t=sjcl.ecc.curves["c"+t],void 0===t))throw new sjcl.exception.invalid("no such curve");r=r||sjcl.bn.random(t.r,i);var a=t.G.mult(r);return{pub:new sjcl.ecc[e].publicKey(t,a),sec:new sjcl.ecc[e].secretKey(t,r)}}},sjcl.ecc.elGamal={generateKeys:sjcl.ecc.basicKey.generateKeys("elGamal"),publicKey:function publicKey(){sjcl.ecc.basicKey.publicKey.apply(this,arguments)},secretKey:function secretKey(){sjcl.ecc.basicKey.secretKey.apply(this,arguments)}},sjcl.ecc.elGamal.publicKey.prototype={kem:function kem(e){var t=sjcl.bn.random(this._curve.r,e),i=this._curve.G.mult(t).toBits(),r=sjcl.hash.sha256.hash(this._point.mult(t).toBits());return{key:r,tag:i}},getType:function getType(){return"elGamal"}},sjcl.ecc.elGamal.secretKey.prototype={unkem:function unkem(e){return sjcl.hash.sha256.hash(this._curve.fromBits(e).mult(this._exponent).toBits())},dh:function dh(e){return sjcl.hash.sha256.hash(e._point.mult(this._exponent).toBits())},dhJavaEc:function dhJavaEc(e){return e._point.mult(this._exponent).x.toBits()},getType:function getType(){return"elGamal"}},sjcl.ecc.ecdsa={generateKeys:sjcl.ecc.basicKey.generateKeys("ecdsa")},sjcl.ecc.ecdsa.publicKey=function(){sjcl.ecc.basicKey.publicKey.apply(this,arguments)},sjcl.ecc.ecdsa.publicKey.prototype={verify:function verify(e,t,i){sjcl.bitArray.bitLength(e)>this._curveBitLength&&(e=sjcl.bitArray.clamp(e,this._curveBitLength));var a=sjcl.bitArray,c=this._curve.r,n=this._curveBitLength,o=sjcl.bn.fromBits(a.bitSlice(t,0,n)),r=sjcl.bn.fromBits(a.bitSlice(t,n,2*n)),l=i?r:r.inverseMod(c),s=sjcl.bn.fromBits(e).mul(l).mod(c),d=o.mul(l).mod(c),u=this._curve.G.mult2(s,d,this._point).x;if(o.equals(0)||r.equals(0)||o.greaterEquals(c)||r.greaterEquals(c)||!u.equals(o)){if(i===void 0)return this.verify(e,t,!0);throw new sjcl.exception.corrupt("signature didn't check out")}return!0},getType:function getType(){return"ecdsa"}},sjcl.ecc.ecdsa.secretKey=function(){sjcl.ecc.basicKey.secretKey.apply(this,arguments)},sjcl.ecc.ecdsa.secretKey.prototype={sign:function sign(e,t,i,a){sjcl.bitArray.bitLength(e)>this._curveBitLength&&(e=sjcl.bitArray.clamp(e,this._curveBitLength));var c=this._curve.r,n=c.bitLength(),o=a||sjcl.bn.random(c.sub(1),t).add(1),l=this._curve.G.mult(o).x.mod(c),r=sjcl.bn.fromBits(e).add(l.mul(this._exponent)),d=i?r.inverseMod(c).mul(o).mod(c):r.mul(o.inverseMod(c)).mod(c);return sjcl.bitArray.concat(l.toBits(n),d.toBits(n))},getType:function getType(){return"ecdsa"}},"undefined"!=typeof module&&module.exports&&(module.exports=sjcl),"function"==typeof define&&define([],function(){return sjcl});